# Codebase Report: Wordcloud Implementation Analysis
Generated: 2026-02-10 10:15:00

## Summary
This is a Node.js/Express web application for a Korean labor law exam study planner. The wordcloud feature was recently added (commit cc79a28) to help users track frequently appearing keywords from exam questions. The implementation is **client-side only** with no Python backend - wordcloud generation happens entirely in the browser using wordcloud2.js library.

## Project Structure
```
/mnt/c/Users/SSAFY/Desktop/ë…¸ë¬´ì‚¬/
  â”œâ”€â”€ server.js              # Express backend (Node.js)
  â”œâ”€â”€ checklist.html         # Main exam checklist page
  â”œâ”€â”€ detail.html            # Wordcloud/keyword analysis page
  â”œâ”€â”€ index.html             # Landing page
  â”œâ”€â”€ login.html             # Login page
  â”œâ”€â”€ checklist.db           # SQLite database
  â”œâ”€â”€ pdfs/                  # Directory for exam PDF files
  â”‚   â””â”€â”€ README.txt         # PDF naming convention guide
  â””â”€â”€ package.json           # Node dependencies
```

**Note:** No Python files exist in this project (only in node_modules/gyp).

---

## Questions Answered

### Q1: Where is detail.html and how is wordcloud displayed?

**Location:** `/mnt/c/Users/SSAFY/Desktop/ë…¸ë¬´ì‚¬/detail.html`

**Wordcloud Display Implementation (Client-Side):**

```html
<!-- Line 6: Library loaded from CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/wordcloud2.js/1.2.2/wordcloud2.min.js"></script>

<!-- Line 35: Canvas element for rendering -->
<canvas id="wordcloud" width="1000" height="800" style="border: 1px solid #ccc; width: 100%; max-width: 1000px;"></canvas>
```

**Generation Logic (Lines 83-129):**
```javascript
// Lines 90-98: Count word frequency from user input
var lines = text.split('\n').filter(function(line) { return line.trim(); });
var wordCount = {};
lines.forEach(function(line) {
    var word = line.trim();
    if (word) {
        wordCount[word] = (wordCount[word] || 0) + 1;
    }
});

// Lines 100-103: Convert to wordcloud format [word, weight]
var list = [];
for (var word in wordCount) {
    list.push([word, wordCount[word] * 10]); // Weight multiplied by 10
}

// Lines 114-128: Render with WordCloud library
WordCloud(canvas, {
    list: list,
    gridSize: 8,
    weightFactor: function(size) {
        return Math.pow(size, 1.5) * 0.5;
    },
    fontFamily: 'Arial, sans-serif',
    color: 'random-dark',
    rotateRatio: 0.3,
    rotationSteps: 2,
    backgroundColor: '#fff',
    minSize: 10,
    drawOutOfBound: false,
    shrinkToFit: true
});
```

**How it Works:**
1. User manually types keywords (one per line) into textarea (line 26)
2. Click "ì›Œë“œ í´ë¼ìš°ë“œ ìƒì„±" button triggers word counting
3. Each unique word's frequency determines its size in the cloud
4. Rendered client-side using wordcloud2.js library
5. No automated extraction from PDFs - purely manual input

---

### Q2: Where is wordcloud data generated?

**Answer:** There is **NO Python backend** for wordcloud generation. The implementation is **100% client-side JavaScript**.

**Data Flow:**
```
User Input (textarea) 
  â†’ JavaScript word counting (detail.html lines 90-98)
  â†’ WordCloud2.js rendering (lines 114-128)
  â†’ Canvas visualization
```

**Storage Backend (server.js):**
```javascript
// Lines 102-117: Keyword retrieval endpoint
app.get('/api/keywords/:examId', (req, res) => {
    const examId = req.params.examId;
    db.get('SELECT keywords FROM keywords WHERE exam_id = ?', [examId], (err, row) => {
        if (err) {
            res.status(500).json({ error: err.message });
            return;
        }
        res.json({ keywords: row ? row.keywords : '' });
    });
});

// Lines 119-135: Keyword save endpoint (login required)
app.post('/api/keywords/:examId', (req, res) => {
    if (req.session.user !== 'yangonebin') {
        return res.status(403).json({ success: false, message: 'ê¶Œí•œ ì—†ìŒ' });
    }
    const examId = req.params.examId;
    const keywords = req.body.keywords;
    db.run('INSERT OR REPLACE INTO keywords (exam_id, keywords) VALUES (?, ?)',
        [examId, keywords],
        (err) => {
            if (err) {
                res.status(500).json({ error: err.message });
                return;
            }
            res.json({ success: true });
        }
    );
});
```

**Database Schema:**
```sql
CREATE TABLE IF NOT EXISTS keywords (
    exam_id TEXT PRIMARY KEY,
    keywords TEXT
)
```
- `exam_id`: Identifier like "2025-1st", "2024-2nd"
- `keywords`: Raw text blob (newline-separated words)

---

### Q3: Where is the Q-Net download link?

**Location:** `/mnt/c/Users/SSAFY/Desktop/ë…¸ë¬´ì‚¬/checklist.html` (line 434)

```html
<p>ì°¸ê³ : <a href="https://www.q-net.or.kr/cst003.do?id=cst00302&gSite=L&gId=05" target="_blank">Q-Net ê¸°ì¶œë¬¸ì œ ë‹¤ìš´ë¡œë“œ</a></p>
```

**URL:** `https://www.q-net.or.kr/cst003.do?id=cst00302&gSite=L&gId=05`

**Potential Error Issues:**
- Opens in new tab (`target="_blank"`)
- External site - may have changed URL structure
- No error handling for dead links
- Users may expect direct PDF access, but must navigate Q-Net site manually

**PDF Storage Instructions (pdfs/README.txt):**
```
íŒŒì¼ëª… í˜•ì‹:
- 2025_34_1.pdf (2025ë…„ë„ ì œ34íšŒ 1êµì‹œ)
- 2025_34_2.pdf (2025ë…„ë„ ì œ33íšŒ 2êµì‹œ ê²½ì˜í•™)
```

**Note:** PDF download logic was **deleted** in commit b9356aa. Previously had server-side PDF serving (commit acde078), but removed - now just external link.

---

### Q4: How are exam questions stored?

**Data Structure:**

**Exam IDs (checklist.html):**
```javascript
// Pattern: {year}-{session}
// Examples from HTML:
"2025-1st"  // 2025ë…„ë„ ì œ34íšŒ ê³µì¸ë…¸ë¬´ì‚¬ 1ì°¨ì‹œí—˜ 1êµì‹œ
"2025-2nd"  // 2025ë…„ë„ ì œ34íšŒ ê³µì¸ë…¸ë¬´ì‚¬ 1ì°¨ì‹œí—˜ 2êµì‹œ(ê²½ì˜í•™)
"2024-1st"  // 2024ë…„ë„ ì œ33íšŒ ê³µì¸ë…¸ë¬´ì‚¬ 1ì°¨ì‹œí—˜ 1êµì‹œ
// ... back to 1992-1st, 1992-2nd
```

**Checklist Database:**
```sql
CREATE TABLE IF NOT EXISTS checklist (
    id TEXT PRIMARY KEY,      -- e.g., "2025-1st"
    checked INTEGER           -- 0 or 1 (boolean)
)
```

**Organization:**
- **By Year:** 1992-2025 (34 years of exams)
- **By Session:** Each year has 2 sessions
  - `1st`: 1êµì‹œ (First session - mixed subjects)
  - `2nd`: 2êµì‹œ(ê²½ì˜í•™) (Second session - Business Management)
- **Total Exams:** 68 exam sessions (34 years Ã— 2 sessions)

**Naming Convention:**
- Checkboxes: `id="2025-1st"`
- Labels: `id="label-2025-1st"`
- Display text: "2025ë…„ë„ ì œ34íšŒ ê³µì¸ë…¸ë¬´ì‚¬ 1ì°¨ì‹œí—˜ 1êµì‹œ"
- PDF files: `2025_34_1.pdf` (underscores, exam number, session)

**Label-to-Link Conversion (checklist.html lines 441-456):**
```javascript
function convertLabelsToLinks() {
    var labels = document.querySelectorAll('label[id^="label-"]');
    labels.forEach(function(label) {
        var text = label.textContent;
        var checkboxId = label.getAttribute('for');

        var link = document.createElement('a');
        link.href = 'detail.html?id=' + checkboxId + '&title=' + encodeURIComponent(text);
        link.textContent = text;
        // ... styling
        label.appendChild(link);
    });
}
```
- Exam titles link to detail.html with exam ID as URL parameter
- detail.html receives `?id=2025-1st&title=...` to load specific keyword data

---

## Architecture Map

```
[Browser Client]
       |
       v
[checklist.html] --click--> [detail.html]
       |                           |
       |                    [WordCloud2.js] (client-side rendering)
       v                           v
[Express Server (server.js)]      |
       |                           |
   [Routes]                  [Manual Input]
       |                           |
    GET /api/checklist            GET /api/keywords/:examId
    POST /api/checklist           POST /api/keywords/:examId
    GET /api/auth/status
    POST /api/auth/login
    POST /api/auth/logout
       |
       v
[SQLite Database (checklist.db)]
       |
  [Tables: checklist, keywords]
```

**Data Flow for Wordcloud:**
1. User clicks exam link in checklist.html
2. Navigates to detail.html?id=2025-1st&title=...
3. detail.html fetches saved keywords via GET /api/keywords/2025-1st
4. User types/edits keywords in textarea
5. Clicks "ì›Œë“œ í´ë¼ìš°ë“œ ìƒì„±" â†’ client-side JS counts words
6. WordCloud2.js renders on canvas
7. Clicks "ì €ì¥" â†’ POST /api/keywords/2025-1st saves to DB

---

## Key Files

| File | Purpose | Entry Points | Line Count |
|------|---------|--------------|------------|
| `server.js` | Express backend, API routes, SQLite | `app.listen(PORT)` | 135 lines |
| `checklist.html` | Main UI, exam list, checkboxes | `window.onload` | 548 lines |
| `detail.html` | Keyword input, wordcloud rendering | URL params `?id=&title=` | 166 lines |
| `checklist.db` | SQLite data storage | 2 tables (checklist, keywords) | - |

**Server Routes (server.js):**
```javascript
GET  /api/checklist              // Load all checkbox states
POST /api/checklist              // Save checkbox states (auth)
GET  /api/auth/status            // Check login status
POST /api/auth/login             // Login (username: yangonebin)
POST /api/auth/logout            // Logout
GET  /api/keywords/:examId       // Load keywords for exam
POST /api/keywords/:examId       // Save keywords (auth)
```

---

## Conventions Discovered

### File Naming
- HTML: lowercase with hyphens (detail.html, checklist.html)
- Database: lowercase with underscores (checklist.db)
- PDFs: `{year}_{examNum}_{session}.pdf` (e.g., 2025_34_1.pdf)

### Exam ID Format
- Pattern: `{year}-{session}` (e.g., 2025-1st, 2025-2nd)
- Years: 1992-2025
- Sessions: "1st" (1êµì‹œ), "2nd" (2êµì‹œ, ê²½ì˜í•™)

### Authentication
- Single hardcoded user: "yangonebin"
- Session-based auth (express-session)
- Cookie lifetime: 24 hours
- Read-only access without login
- Write operations require login (checklist, keywords)

### JavaScript Style
- Vanilla JS (no frameworks)
- ES5 syntax (function declarations, var)
- Inline event handlers (`onchange="saveCheck(this)"`)
- Fetch API for AJAX requests

---

## Open Questions / Potential Issues

### Q-Net Link Error
- **Issue:** External link may be broken or changed
- **Location:** checklist.html:434
- **Current URL:** `https://www.q-net.or.kr/cst003.do?id=cst00302&gSite=L&gId=05`
- **Recommendation:** Add error checking or update URL if Q-Net site changed

### Manual Keyword Entry
- **Issue:** Users must manually type keywords (tedious for 68 exams)
- **Current:** No automated extraction from PDFs
- **Potential Enhancement:** Could add PDF text extraction (pdf.js or server-side PDF parsing)

### Limited Wordcloud Analysis
- **Current:** Simple frequency counting (each occurrence adds 1)
- **Enhancement Ideas:**
  - TF-IDF scoring across multiple exams
  - Filter common words (the, a, and, etc.)
  - Synonym grouping
  - Year-over-year trend analysis

### No Subject-Level Breakdown
- **Current:** Keywords stored per exam (1st/2nd session)
- **Enhancement:** Could track by subject within 1êµì‹œ:
  - ê·¼ë¡œê¸°ì¤€ë²• (Labor Standards Act)
  - ë…¸ë™ì¡°í•©ë²• (Trade Union Act)
  - ê³ ìš©ë³´í—˜ë²• (Employment Insurance Act)
  - etc.

---

## Recent Changes (Git History)

```
bd95a86 ğŸ› [FIX] : ë¡œê·¸ì¸ ì¼ê´€ì„± ìˆ˜ì •
cc79a28 âœ¨ [FEAT] : ì›Œë“œ í´ë¼ìš°ë“œ ìƒì„±          â† Wordcloud feature added
b9356aa â– [DELETE] : pdf ë‹¤ìš´ë¡œë“œ ë¡œì§ ì‚­ì œ   â† PDF download removed
acde078 âœ¨ [FEAT] : pdf ë‹¤ìš´ë¡œë“œ ì¶”ê°€          â† PDF download added (then removed)
5e3deb8 ğŸ¨ [fix] : ë¡œê·¸ì¸ ìœ„ì¹˜ ìˆ˜ì •
```

**Wordcloud Commit (cc79a28) Added:**
- detail.html (148 lines)
- Server routes for keywords (/api/keywords/:examId)
- Database table for keywords
- Link from checklist labels to detail page
- package-lock.json updates (wordcloud2.js dependency)

---

## Summary of Findings

1. **Wordcloud is 100% Client-Side** - No Python backend exists. Uses wordcloud2.js JavaScript library.

2. **Data Storage is Simple** - SQLite stores raw keyword text (newline-separated). No sophisticated NLP or preprocessing.

3. **Q-Net Link** - Located at checklist.html:434. Direct external link, may need updating if site changed.

4. **Exam Structure** - 68 exams (1992-2025, 2 per year), identified by "{year}-{session}" pattern.

5. **Manual Workflow** - Users download PDFs from Q-Net â†’ manually type keywords â†’ generate wordcloud â†’ save to DB.

6. **Authentication** - Single-user system (yangonebin), session-based, read-only for guests.

